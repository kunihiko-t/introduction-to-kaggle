<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><meta name="theme-color" content="#3498db"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="ソフトウェア開発者がとりあえずKaggleを始める方法"><title>Introduction to Kaggle for Software Engineers</title><meta property="og:title" content="Introduction to Kaggle for Software Engineers"><meta property="og:type" content="article"><meta property="og:description" content="ソフトウェア開発者がとりあえずKaggleを始める方法"><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><link href="vendor.6.c9a6d243b91f1dfe3fc8.css" rel="stylesheet"><link href="main.3.1c23ead6bb8bc9504bf9.css" rel="stylesheet"></head><body><div id="root"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="btn-sidebar" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg><article id="webslides"><section class="aligncenter title"><h1>Kaggleを始めるためのハンズオン</h1><br><br><h4>Kunihiko Tanaka</h4></section><section class="aligncenter title"><div class="toc size-70 aligncenter"><ol><li><a href="#slide=3" title="Kaggleって何？"><span class="chapter">Kaggleって何？</span><span class="toc-page">3</span></a></li><li><a href="#slide=13" title="機械学習の基礎:回帰"><span class="chapter">機械学習の基礎:回帰</span><span class="toc-page">13</span></a></li><li><a href="#slide=40" title="機械学習の基礎:分類"><span class="chapter">機械学習の基礎:分類</span><span class="toc-page">40</span></a></li><li><a href="#slide=56" title="過学習"><span class="chapter">過学習</span><span class="toc-page">56</span></a></li><li><a href="#slide=59" title="過学習"><span class="chapter">過学習</span><span class="toc-page">59</span></a></li></ol></div></section><section class="aligncenter section-title"><h2>Kaggleって何？</h2></section><section class="aligncenter"><h1>企業や研究者がデータとお題を投稿し、</h1><h1>ユーザがその最適モデルを作成し競い合うプラットフォーム</h1></section><section class="aligncenter fullscreen"><p><img src="https://dludl99l2zhc1.cloudfront.net/items/2b2N1w3T1F3I2y0f3H0Z/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202019-08-31%2014.52.54.png" alt="Petfinder"> <a href="https://www.kaggle.com/c/petfinder-adoption-prediction/overview">https://www.kaggle.com/c/petfinder-adoption-prediction/overview</a></p></section><section class="aligncenter fullscreen"><p><img src="https://cl.ly/7ee1650bb98b/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-08-31%25252015.00.20.png" alt="Titanic"> <a href="https://www.kaggle.com/c/titanic">https://www.kaggle.com/c/titanic</a></p></section><section class="aligncenter"><h1>とりあえず始めるには何が必要なのか？</h1></section><section class="aligncenter"><h2>Pythonと機械学習によく使うライブラリの基礎知識</h2><ul><li>numpy どこでも使うので覚えるしかない</li><li>pandas CSVからデータを読み込んでデータフレームにして処理したり可視化したりする。データフレームからCSVをエクスポートしたりもする</li><li>scikit-learn データに対する様々な処理や各種機械学習アルゴリズムの適用、便利ユーティリティなど</li><li>matplotlib グラフを書く。jupyter notebookで確認する時など</li></ul></section><section class="aligncenter"><h2>機械学習の基礎</h2><ul><li>回帰（値の予測）</li><li>メールのフィルタとかドキュメントの分類とか</li><li>分類(カテゴリ分けとか)</li><li>Courseraのmachine learningのコース　<a href="https://ja.coursera.org/learn/machine-learning">https://ja.coursera.org/learn/machine-learning</a> (修了証いらなければ無料でいける)<ul><li>手早くDeep LearningもやりたいならニューラルネットワークまでやってからDeep Learningに移っても良さそう</li></ul></li></ul></section><section class="aligncenter"><h2>Deep Learningの基礎</h2><ul><li>自然言語処理(RNNとかAttentionとか)</li><li>画像処理(CNNとか)</li><li>Courseraのdeep learningのコース <a href="https://ja.coursera.org/specializations/deep-learning">https://ja.coursera.org/specializations/deep-learning</a></li><li>Keras + Tensorflow or PyTorch or Fast.aiのライブラリなど</li></ul></section><section class="aligncenter"><h2>GPUとかTPU + メモリいっぱい</h2><ul><li>GCPのCompute Engine (プリエンプティブインスタンス使うと安い。EC2のスポットインスタンスみたいなやつ。1時間0.3-0.5ドル)</li><li>Google Colaboratory使っても良い（メモリ足りないやつとかもあるので注意） <a href="https://colab.research.google.com">https://colab.research.google.com</a></li></ul></section><section class="aligncenter"><h1>とりあえずこのへんの基礎的なことが分かればKaggleで遊べるので順番にやっていく</h1><p>参考：<a href="https://qiita.com/upura/items/3c10ff6fed4e7c3d70f0">https://qiita.com/upura/items/3c10ff6fed4e7c3d70f0</a></p></section><section class="aligncenter section-title"><h2>回帰と分類</h2><p>機械学習のアルゴリズムは2種類に分けられる。</p><p>値を予測する<em>回帰</em>と、入力値を識別する<em>分類</em></p></section><section class="aligncenter"><h2>線形回帰</h2><p>一番簡単な回帰のアルゴリズム</p><p>入力された値から予測値を返す</p><p>例えば間取りを入力して住宅の予測価格を出力など</p></section><section class="aligncenter"><table><thead><tr><th>平均部屋数</th><th>住宅価格 単位：$1,000</th></tr></thead><tbody><tr><td>6.575</td><td>24.0</td></tr><tr><td>6.421</td><td>21.6</td></tr><tr><td>7.185</td><td>34.7</td></tr><tr><td>6.998</td><td>33.4</td></tr><tr><td>7.147</td><td>36.2</td></tr><tr><td>6.430</td><td>28.7</td></tr><tr><td>6.012</td><td>22.9</td></tr><tr><td>6.172</td><td>27.1</td></tr><tr><td>5.631</td><td>16.5</td></tr><tr><td>6.004</td><td>18.9</td></tr></tbody></table></section><section class="aligncenter fullscreen"><p><img src="https://cl.ly/83558118d6fc/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252012.37.03.png" alt="グラフ"></p></section><section class="aligncenter"><h2>どうやって予測する？</h2></section><section class="aligncenter"><p>こうやって線引けばなんとなく予測できそう</p><p><img src="https://cl.ly/811ea9643683/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252013.02.20.png" alt="グラフ"></p></section><section class="aligncenter"><h2>どうやって線を引くか</h2><p>直線なので切片と傾きがあれば描画できそう</p></section><section class="aligncenter"><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>:</mo><mi mathvariant="normal">平</mi><mi mathvariant="normal">均</mi><mi mathvariant="normal">部</mi><mi mathvariant="normal">屋</mi><mi mathvariant="normal">数</mi></mrow><annotation encoding="application/x-tex">x: 平均部屋数</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em"></span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">部</span><span class="mord cjk_fallback">屋</span><span class="mord cjk_fallback">数</span></span></span></span></span></div><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>:</mo><mtext>            </mtext><mi mathvariant="normal">価</mi><mi mathvariant="normal">格</mi></mrow><annotation encoding="application/x-tex">y: ~~~~~~~~~~~~ 価格</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">価</span><span class="mord cjk_fallback">格</span></span></span></span></span></div><br>$$ \huge h_\theta(x) = \theta_0 + \theta_1x $$<br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext>      </mtext><mi mathvariant="normal">予</mi><mi mathvariant="normal">測</mi><mi mathvariant="normal">値</mi></mrow><annotation encoding="application/x-tex">h_\theta(x) ~~~~~~ 予測値</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">予</span><span class="mord cjk_fallback">測</span><span class="mord cjk_fallback">値</span></span></span></span></span></div><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>0</mn></msub><mtext>               </mtext><mi mathvariant="normal">切</mi><mi mathvariant="normal">片</mi></mrow><annotation encoding="application/x-tex">\theta_0 ~~~~~~~~~~~~~~~ 切片</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">切</span><span class="mord cjk_fallback">片</span></span></span></span></span></div><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mi>x</mi><mtext>             </mtext><mi mathvariant="normal">傾</mi><mi mathvariant="normal">き</mi></mrow><annotation encoding="application/x-tex">\theta_1x ~~~~~~~~~~~~~ 傾き</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">傾</span><span class="mord cjk_fallback">き</span></span></span></span></span></div><br><h3>仮説関数と呼ぶ</h3></section><section class="aligncenter"><h3>つまり</h3><br>$$ \huge h_\theta(x) - y $$<br><h3>を最小化する</h3><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="2.074em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub></mstyle></mrow><annotation encoding="application/x-tex">\huge \theta_0,\theta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8435371199999997em;vertical-align:-0.40326856em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size10">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></div><br><h3>を求めれば良さそう</h3></section><section class="aligncenter"><h3>m個のサンプルがあるのでこうなる</h3><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="2.074em"><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\huge \frac{1}{2m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.06201994em;vertical-align:-2.64210317em"></span><span class="mord sizing reset-size6 size10"><span class="mopen nulldelimiter sizing reset-size10 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-3.388em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-4.304em"><span class="pstrut" style="height:4.074em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-4.7509999999999994em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size10 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size10"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6489473336547735em"><span style="top:-2.900083331726133em;margin-left:0em"><span class="pstrut" style="height:4.074em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-4.074005em"><span class="pstrut" style="height:4.074em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-5.324005em;margin-left:0em"><span class="pstrut" style="height:4.074em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.273916668273867em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33215699132111853em"><span style="top:-3.29em;margin-left:0em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9337328833172613em"><span style="top:-3.853em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.455062em;vertical-align:-0.5185em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9337328833172613em"><span style="top:-3.853em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8604414657666345em"><span style="top:-3.8529999999999998em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mtext>  </mtext><mi>i</mi><mi mathvariant="normal">番</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">サ</mi><mi mathvariant="normal">ン</mi><mi mathvariant="normal">プ</mi><mi mathvariant="normal">ル</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">値</mi></mrow><annotation encoding="application/x-tex">x^{(i)} ~~ i番目のサンプルの値</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">番</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">サ</span><span class="mord cjk_fallback">ン</span><span class="mord cjk_fallback">プ</span><span class="mord cjk_fallback">ル</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">値</span></span></span></span></span></div><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mtext>  </mtext><mi mathvariant="normal">計</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">や</mi><mi mathvariant="normal">す</mi><mi mathvariant="normal">く</mi><mi mathvariant="normal">す</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">た</mi><mi mathvariant="normal">め</mi><mi mathvariant="normal">掛</mi><mi mathvariant="normal">け</mi><mi mathvariant="normal">て</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">だ</mi><mi mathvariant="normal">け</mi></mrow><annotation encoding="application/x-tex">\frac{1}{2} ~~ 計算しやすくするため掛けてるだけ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">計</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">し</span><span class="mord cjk_fallback">や</span><span class="mord cjk_fallback">す</span><span class="mord cjk_fallback">く</span><span class="mord cjk_fallback">す</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">た</span><span class="mord cjk_fallback">め</span><span class="mord cjk_fallback">掛</span><span class="mord cjk_fallback">け</span><span class="mord cjk_fallback">て</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">だ</span><span class="mord cjk_fallback">け</span></span></span></span></span></div><br><h3>誤差を二乗しているので二乗誤差という(平均二乗誤差)</h3></section><section class="aligncenter"><h2>これを目的関数(cost function)と呼ぶ</h2><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="2.074em"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\huge J(\theta_0, \theta_1) = \frac{1}{2m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.074em;vertical-align:-0.5185em"></span><span class="mord mathdefault sizing reset-size6 size10" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size10">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size10">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.06201994em;vertical-align:-2.64210317em"></span><span class="mord sizing reset-size6 size10"><span class="mopen nulldelimiter sizing reset-size10 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-3.388em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-4.304em"><span class="pstrut" style="height:4.074em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-4.7509999999999994em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size10 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size10"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6489473336547735em"><span style="top:-2.900083331726133em;margin-left:0em"><span class="pstrut" style="height:4.074em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-4.074005em"><span class="pstrut" style="height:4.074em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-5.324005em;margin-left:0em"><span class="pstrut" style="height:4.074em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.273916668273867em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33215699132111853em"><span style="top:-3.29em;margin-left:0em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9337328833172613em"><span style="top:-3.853em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.455062em;vertical-align:-0.5185em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9337328833172613em"><span style="top:-3.853em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8604414657666345em"><span style="top:-3.8529999999999998em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><br><h3>二乗誤差は線形回帰問題で効果的なのでよく使われる</h3></section><section class="aligncenter"><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi>y</mi><mi>p</mi><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>s</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">Hypothesis:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathdefault" style="margin-right:0.08125em">H</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><mi>x</mi></mstyle></mrow><annotation encoding="application/x-tex">\large h_\theta(x) = \theta_0 + \theta_1x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathdefault sizing reset-size6 size7">x</span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>s</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">Parameters:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathdefault" style="margin-right:0.13889em">P</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_0,\theta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">Const Function:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathdefault" style="margin-right:0.07153em">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.13889em">F</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large J(\theta_0, \theta_1) = \frac{1}{2m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>o</mi><mi>a</mi><mi>l</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">Goal:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathdefault">G</span><span class="mord mathdefault">o</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>m</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>z</mi><mi>e</mi><mtext> </mtext><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large minimize~J(\theta_0, \theta_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.04398em">z</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div></section><section class="aligncenter"><h2>目的関数を最小化する</h2></section><section class="aligncenter"><h2>最急降下法(Gradient Decent)</h2><p>関数を最小化するのによく使われる方法</p><p>他には確率的勾配降下法(stochastic gradient descent, SGD)とかもある</p></section><section class="aligncenter"><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">に</mi><mi mathvariant="normal">対</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">て</mi><mi mathvariant="normal">そ</mi><mi mathvariant="normal">れ</mi><mi mathvariant="normal">を</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">小</mi><mi mathvariant="normal">化</mi><mi mathvariant="normal">す</mi><mi mathvariant="normal">る</mi><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">が</mi><mi mathvariant="normal">欲</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">い</mi><mi mathvariant="normal">。</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">最</mi><mi mathvariant="normal">急</mi><mi mathvariant="normal">降</mi><mi mathvariant="normal">下</mi><mi mathvariant="normal">法</mi><mi mathvariant="normal">で</mi><mi mathvariant="normal">は</mi><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">に</mi><mi mathvariant="normal">対</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">て</mi><mi mathvariant="normal">初</mi><mi mathvariant="normal">期</mi><mi mathvariant="normal">値</mi><mi mathvariant="normal">を</mi><mi mathvariant="normal">設</mi><mi mathvariant="normal">定</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">（</mi><mi mathvariant="normal">何</mi><mi mathvariant="normal">で</mi><mi mathvariant="normal">も</mi><mi mathvariant="normal">良</mi><mi mathvariant="normal">い</mi><mi mathvariant="normal">が</mi><mn>0</mn><mi mathvariant="normal">が</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">般</mi><mi mathvariant="normal">的</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">を</mi><mi mathvariant="normal">変</mi><mi mathvariant="normal">化</mi><mi mathvariant="normal">さ</mi><mi mathvariant="normal">せ</mi><mi mathvariant="normal">続</mi><mi mathvariant="normal">け</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">終</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">に</mi><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">を</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">小</mi><mi mathvariant="normal">化</mi><mi mathvariant="normal">さ</mi><mi mathvariant="normal">せ</mi><mi mathvariant="normal">る</mi><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">を</mi><mi mathvariant="normal">見</mi><mi mathvariant="normal">つ</mi><mi mathvariant="normal">け</mi><mi mathvariant="normal">る</mi></mstyle></mstyle></mstyle></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\large J(\theta_0, \theta_1) に対してそれを最小化する \\ \large \theta_0,\theta_1 が欲しい。 \\ 最急降下法では \\ \large \theta_0,\theta_1 に対して初期値を設定し（何でも良いが0が一般的) \\ \large \theta_0,\theta_1 を変化させ続け最終的に \\ \large J(\theta_0, \theta_1) を最小化させる \large \theta_0,\theta_1 を見つける</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mord cjk_fallback sizing reset-size6 size7">に</span><span class="mord cjk_fallback sizing reset-size6 size7">対</span><span class="mord cjk_fallback sizing reset-size6 size7">し</span><span class="mord cjk_fallback sizing reset-size6 size7">て</span><span class="mord cjk_fallback sizing reset-size6 size7">そ</span><span class="mord cjk_fallback sizing reset-size6 size7">れ</span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">最</span><span class="mord cjk_fallback sizing reset-size6 size7">小</span><span class="mord cjk_fallback sizing reset-size6 size7">化</span><span class="mord cjk_fallback sizing reset-size6 size7">す</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">が</span><span class="mord cjk_fallback sizing reset-size6 size7">欲</span><span class="mord cjk_fallback sizing reset-size6 size7">し</span><span class="mord cjk_fallback sizing reset-size6 size7">い</span><span class="mord cjk_fallback sizing reset-size6 size7">。</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em"></span><span class="mord cjk_fallback sizing reset-size6 size7">最</span><span class="mord cjk_fallback sizing reset-size6 size7">急</span><span class="mord cjk_fallback sizing reset-size6 size7">降</span><span class="mord cjk_fallback sizing reset-size6 size7">下</span><span class="mord cjk_fallback sizing reset-size6 size7">法</span><span class="mord cjk_fallback sizing reset-size6 size7">で</span><span class="mord cjk_fallback sizing reset-size6 size7">は</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">に</span><span class="mord cjk_fallback sizing reset-size6 size7">対</span><span class="mord cjk_fallback sizing reset-size6 size7">し</span><span class="mord cjk_fallback sizing reset-size6 size7">て</span><span class="mord cjk_fallback sizing reset-size6 size7">初</span><span class="mord cjk_fallback sizing reset-size6 size7">期</span><span class="mord cjk_fallback sizing reset-size6 size7">値</span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">設</span><span class="mord cjk_fallback sizing reset-size6 size7">定</span><span class="mord cjk_fallback sizing reset-size6 size7">し</span><span class="mord cjk_fallback sizing reset-size6 size7">（</span><span class="mord cjk_fallback sizing reset-size6 size7">何</span><span class="mord cjk_fallback sizing reset-size6 size7">で</span><span class="mord cjk_fallback sizing reset-size6 size7">も</span><span class="mord cjk_fallback sizing reset-size6 size7">良</span><span class="mord cjk_fallback sizing reset-size6 size7">い</span><span class="mord cjk_fallback sizing reset-size6 size7">が</span><span class="mord sizing reset-size6 size7">0</span><span class="mord cjk_fallback sizing reset-size6 size7">が</span><span class="mord cjk_fallback sizing reset-size6 size7">一</span><span class="mord cjk_fallback sizing reset-size6 size7">般</span><span class="mord cjk_fallback sizing reset-size6 size7">的</span><span class="mclose sizing reset-size6 size7">)</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">変</span><span class="mord cjk_fallback sizing reset-size6 size7">化</span><span class="mord cjk_fallback sizing reset-size6 size7">さ</span><span class="mord cjk_fallback sizing reset-size6 size7">せ</span><span class="mord cjk_fallback sizing reset-size6 size7">続</span><span class="mord cjk_fallback sizing reset-size6 size7">け</span><span class="mord cjk_fallback sizing reset-size6 size7">最</span><span class="mord cjk_fallback sizing reset-size6 size7">終</span><span class="mord cjk_fallback sizing reset-size6 size7">的</span><span class="mord cjk_fallback sizing reset-size6 size7">に</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">最</span><span class="mord cjk_fallback sizing reset-size6 size7">小</span><span class="mord cjk_fallback sizing reset-size6 size7">化</span><span class="mord cjk_fallback sizing reset-size6 size7">さ</span><span class="mord cjk_fallback sizing reset-size6 size7">せ</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">見</span><span class="mord cjk_fallback sizing reset-size6 size7">つ</span><span class="mord cjk_fallback sizing reset-size6 size7">け</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span></span></span></span></span></div></section><section class="aligncenter"><p>ある点からスタートして、ひたすら下に進むのが最急降下法。局所解に陥ることもある</p><p><img src="https://cl.ly/45f649e8921b/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252014.27.17.png" alt="Gradient Decent"></p></section><section class="aligncenter"><p>線形回帰の場合はこんな形になるので局所最適解が何個も現れることはない</p><p><img src="https://cl.ly/5dbf61f2b0ce/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252017.17.37.png" alt="Gradient Decent"></p></section><section class="aligncenter"><h2>最急降下法のアルゴリズム</h2><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mi>j</mi></msub><mi mathvariant="normal">が</mi><mi mathvariant="normal">収</mi><mi mathvariant="normal">束</mi><mi mathvariant="normal">す</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">ま</mi><mi mathvariant="normal">で</mi></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_j が収束するまで</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">が</span><span class="mord cjk_fallback sizing reset-size6 size7">収</span><span class="mord cjk_fallback sizing reset-size6 size7">束</span><span class="mord cjk_fallback sizing reset-size6 size7">す</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span><span class="mord cjk_fallback sizing reset-size6 size7">ま</span><span class="mord cjk_fallback sizing reset-size6 size7">で</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="2.074em"><msub><mi>θ</mi><mi>j</mi></msub><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\huge \theta_j := \theta_j - \alpha \frac{\partial}{\partial \theta_j}J(\theta_0 , \theta_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0313621599999996em;vertical-align:-0.5910936em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30791166827386696em"><span style="top:-3.2899999999999996em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.28500173577627774em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size10">:</span></span><span class="base"><span class="strut" style="height:0.7608883799999999em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size10">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.0313621599999996em;vertical-align:-0.5910936em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30791166827386696em"><span style="top:-3.2899999999999996em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.28500173577627774em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size10">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:4.85822416em;vertical-align:-2.0138576em"></span><span class="mord mathdefault sizing reset-size6 size10" style="margin-right:0.0037em">α</span><span class="mord sizing reset-size6 size10"><span class="mopen nulldelimiter sizing reset-size10 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-3.388em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30791166827386696em"><span style="top:-3.2899999999999996em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.28500173577627774em"><span></span></span></span></span></span></span></span></span><span style="top:-4.304em"><span class="pstrut" style="height:4.074em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-4.7509999999999994em"><span class="pstrut" style="height:4.074em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9710017357762778em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size10 size6"></span></span><span class="mord mathdefault sizing reset-size6 size10" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size10">(</span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size10">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size10"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29744146576663455em"><span style="top:-3.29em;margin-left:-0.02778em;margin-right:0.02410800385728062em"><span class="pstrut" style="height:3.44em"></span><span class="sizing reset-size10 size8 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size10">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mo stretchy="false">(</mo><mi>f</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>j</mi><mo>=</mo><mn>0</mn><mtext> </mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext> </mtext><mi>j</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large (for~j=0~and~j=1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10764em">f</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.02778em">r</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.05724em">j</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em"></span><span class="mord sizing reset-size6 size7">0</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7">a</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mord mathdefault sizing reset-size6 size7">d</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.05724em">j</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7">1</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mo>:</mo><mi mathvariant="normal">学</mi><mi mathvariant="normal">習</mi><mi mathvariant="normal">率</mi><mo stretchy="false">(</mo><mi mathvariant="normal">ど</mi><mi mathvariant="normal">れ</mi><mi mathvariant="normal">だ</mi><mi mathvariant="normal">け</mi><mi mathvariant="normal">大</mi><mi mathvariant="normal">き</mi><mi mathvariant="normal">く</mi><mi mathvariant="normal">坂</mi><mi mathvariant="normal">を</mi><mi mathvariant="normal">降</mi><mi mathvariant="normal">り</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">か</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha : 学習率(どれだけ大きく坂を降りるか)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.516672em;vertical-align:0em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord cjk_fallback sizing reset-size6 size7">学</span><span class="mord cjk_fallback sizing reset-size6 size7">習</span><span class="mord cjk_fallback sizing reset-size6 size7">率</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord cjk_fallback sizing reset-size6 size7">ど</span><span class="mord cjk_fallback sizing reset-size6 size7">れ</span><span class="mord cjk_fallback sizing reset-size6 size7">だ</span><span class="mord cjk_fallback sizing reset-size6 size7">け</span><span class="mord cjk_fallback sizing reset-size6 size7">大</span><span class="mord cjk_fallback sizing reset-size6 size7">き</span><span class="mord cjk_fallback sizing reset-size6 size7">く</span><span class="mord cjk_fallback sizing reset-size6 size7">坂</span><span class="mord cjk_fallback sizing reset-size6 size7">を</span><span class="mord cjk_fallback sizing reset-size6 size7">降</span><span class="mord cjk_fallback sizing reset-size6 size7">り</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span><span class="mord cjk_fallback sizing reset-size6 size7">か</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>:</mo><mi mathvariant="normal">導</mi><mi mathvariant="normal">関</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">項</mi></mstyle></mrow><annotation encoding="application/x-tex">\large \alpha \frac{\partial}{\partial \theta_j}J(\theta_0 , \theta_1) : 導関数項</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.80448em;vertical-align:-1.158752em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9656266666666667em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em"></span><span class="mord cjk_fallback sizing reset-size6 size7">導</span><span class="mord cjk_fallback sizing reset-size6 size7">関</span><span class="mord cjk_fallback sizing reset-size6 size7">数</span><span class="mord cjk_fallback sizing reset-size6 size7">項</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi><mn>0</mn><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>0</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large temp0 := \theta_0 - \alpha \frac{\partial}{\partial \theta_0}J(\theta_0 , \theta_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.006656em;vertical-align:-0.23332799999999998em"></span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">p</span><span class="mord sizing reset-size6 size7">0</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.6489279999999997em;vertical-align:-1.0032em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.514em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi><mn>1</mn><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>1</mn></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large temp1 := \theta_1 - \alpha \frac{\partial}{\partial \theta_1}J(\theta_0 , \theta_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.006656em;vertical-align:-0.23332799999999998em"></span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">p</span><span class="mord sizing reset-size6 size7">1</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.6489279999999997em;vertical-align:-1.0032em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.514em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo>:</mo><mo>=</mo><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_0 := temp0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.006656em;vertical-align:-0.23332799999999998em"></span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">p</span><span class="mord sizing reset-size6 size7">0</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_1 := temp1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.006656em;vertical-align:-0.23332799999999998em"></span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">p</span><span class="mord sizing reset-size6 size7">1</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">は</mi><mi mathvariant="normal">同</mi><mi mathvariant="normal">時</mi><mi mathvariant="normal">に</mi><mi mathvariant="normal">更</mi><mi mathvariant="normal">新</mi><mi mathvariant="normal">す</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">こ</mi><mi mathvariant="normal">と</mi></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_0, \theta_1は同時に更新すること</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback sizing reset-size6 size7">は</span><span class="mord cjk_fallback sizing reset-size6 size7">同</span><span class="mord cjk_fallback sizing reset-size6 size7">時</span><span class="mord cjk_fallback sizing reset-size6 size7">に</span><span class="mord cjk_fallback sizing reset-size6 size7">更</span><span class="mord cjk_fallback sizing reset-size6 size7">新</span><span class="mord cjk_fallback sizing reset-size6 size7">す</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span><span class="mord cjk_fallback sizing reset-size6 size7">こ</span><span class="mord cjk_fallback sizing reset-size6 size7">と</span></span></span></span></span></div></section><section class="aligncenter"><h2>動作イメージ</h2><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">と</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">て</mi><mi mathvariant="normal">考</mi><mi mathvariant="normal">え</mi><mi mathvariant="normal">て</mi><mi mathvariant="normal">み</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">と</mi><mi mathvariant="normal">下</mi><mi mathvariant="normal">図</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">よ</mi><mi mathvariant="normal">う</mi><mi mathvariant="normal">に</mi><mi mathvariant="normal">な</mi><mi mathvariant="normal">る</mi></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_0 = 0 として考えてみると下図のようになる</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.773328em;vertical-align:0em"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord cjk_fallback sizing reset-size6 size7">と</span><span class="mord cjk_fallback sizing reset-size6 size7">し</span><span class="mord cjk_fallback sizing reset-size6 size7">て</span><span class="mord cjk_fallback sizing reset-size6 size7">考</span><span class="mord cjk_fallback sizing reset-size6 size7">え</span><span class="mord cjk_fallback sizing reset-size6 size7">て</span><span class="mord cjk_fallback sizing reset-size6 size7">み</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span><span class="mord cjk_fallback sizing reset-size6 size7">と</span><span class="mord cjk_fallback sizing reset-size6 size7">下</span><span class="mord cjk_fallback sizing reset-size6 size7">図</span><span class="mord cjk_fallback sizing reset-size6 size7">の</span><span class="mord cjk_fallback sizing reset-size6 size7">よ</span><span class="mord cjk_fallback sizing reset-size6 size7">う</span><span class="mord cjk_fallback sizing reset-size6 size7">に</span><span class="mord cjk_fallback sizing reset-size6 size7">な</span><span class="mord cjk_fallback sizing reset-size6 size7">る</span></span></span></span></span></div><br><p><img src="https://cl.ly/e68d5bfc10d0/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252015.06.20.png" alt="Gradient Decent"></p><br><p>導関数は二次関数の接線になるのでθ1が二次関数の右側のほうにあると導関数は正の関数となり、左側にあると負の関数となる。</p><p>そのため学習率を小さくすると小さいステップで正解に向かって進み、大きいとステップも大きくなる。</p></section><section class="aligncenter"><p>学習率が小さすぎると学習に時間がかかり、大きすぎると局所解まで辿り着けない</p><p><img src="https://cl.ly/945f0840d47b/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252015.14.34.png" alt="Gradient Decent"></p></section><section class="aligncenter"><h1>線形回帰のモデルに最急降下法を適用する</h1></section><section class="aligncenter"><h3>1. 最急降下法のアルゴリズム</h3><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mi>j</mi></msub><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mi>α</mi><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_j := \theta_j - \alpha \frac{\partial}{\partial \theta_j}J(\theta_0 , \theta_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.80448em;vertical-align:-1.158752em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9656266666666667em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><br><h3>2. 線形回帰のモデル</h3><br><p>仮説関数</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><mi>x</mi></mstyle></mrow><annotation encoding="application/x-tex">\large h_\theta(x) = \theta_0 + \theta_1x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathdefault sizing reset-size6 size7">x</span></span></span></span></span></div><br><p>目的関数（最急降下法の導関数の部分はこれを使う 3を参照）</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large J(\theta_0, \theta_1) = \frac{1}{2m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><br><h3>3. 導関数はこうなる</h3><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large \frac{\partial}{\partial \theta_j} J(\theta_0, \theta_1) = \frac{\partial}{\partial \theta_j} \frac{1}{2m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.80448em;vertical-align:-1.158752em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9656266666666667em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9656266666666667em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mi>j</mi></msub></mrow></mfrac><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large = \frac{\partial}{\partial \theta_j} \frac{1}{2m}\sum_{i = 1}^{m}(\theta_0 + \theta_1x^{(i)} - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9656266666666667em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2755999999999998em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><h3>4. j=0のケースとj=1のケースで偏微分する</h3><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>0</mn></msub><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>0</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_0 = \frac{\partial}{\partial \theta_0} = \frac{1}{m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.6489279999999997em;vertical-align:-1.0032em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.514em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>θ</mi><mn>1</mn></msub><mo>=</mo><mfrac><mi mathvariant="normal">∂</mi><mrow><mi mathvariant="normal">∂</mi><msub><mi>θ</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\large \theta_1 = \frac{\partial}{\partial \theta_1} = \frac{1}{m}\sum_{i = 1}^{m}(h_\theta(x^{(i)}) - y^{(i)} )x^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.013328em;vertical-align:-0.18em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.6489279999999997em;vertical-align:-1.0032em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span style="top:-2.514em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></div></section><section class="aligncenter"><h2>あとはこれを解けばいいけど、さすがに１から書くのもしんどいのでscikit-learnを使う。</h2></section><section class="aligncenter"><h2>Google Colaboratoryを使おう</h2></section><section class="aligncenter"><h2>転置について</h2></section><section class="aligncenter"><h2>線形回帰で特徴量が複数あるとき</h2><p>例えば身長、体重、年齢みたいな３つの特徴量を線形回帰に使いたいとすると</p><p>i番目のサンプルのj番目の特徴量をどう表すのか？</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>i</mi><mi mathvariant="normal">番</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">サ</mi><mi mathvariant="normal">ン</mi><mi mathvariant="normal">プ</mi><mi mathvariant="normal">ル</mi></mrow><annotation encoding="application/x-tex">x^{(i)}= i番目のサンプル</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.938em;vertical-align:0em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em"></span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">番</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">サ</span><span class="mord cjk_fallback">ン</span><span class="mord cjk_fallback">プ</span><span class="mord cjk_fallback">ル</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>x</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><mi>i</mi><mi mathvariant="normal">番</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">サ</mi><mi mathvariant="normal">ン</mi><mi mathvariant="normal">プ</mi><mi mathvariant="normal">ル</mi><mi mathvariant="normal">の</mi><mi>j</mi><mi mathvariant="normal">番</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">特</mi><mi mathvariant="normal">徴</mi><mi mathvariant="normal">量</mi></mrow><annotation encoding="application/x-tex">x^{(i)}_j= i番目のサンプルのj番目の特徴量</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em"></span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">番</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">サ</span><span class="mord cjk_fallback">ン</span><span class="mord cjk_fallback">プ</span><span class="mord cjk_fallback">ル</span><span class="mord cjk_fallback">の</span><span class="mord mathdefault" style="margin-right:0.05724em">j</span><span class="mord cjk_fallback">番</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">特</span><span class="mord cjk_fallback">徴</span><span class="mord cjk_fallback">量</span></span></span></span></span></div></section><section class="aligncenter"><h2>仮説関数の変更</h2><p>今まで使っていたのは</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><mi>x</mi></mrow><annotation encoding="application/x-tex">h_\theta(x) = \theta_0 + \theta_1x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span></span></div><br><p>これを複数の特徴量に対応させるとこうなる</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>θ</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">h_\theta(x) = \theta_0 + \theta_1x_1 + \theta_2x_2 + \theta_3x_3 + ..... + \theta_nx_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></div><br><p>ここでx0を1とすると</p><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="right right right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>θ</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="right right right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>θ</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>θ</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>θ</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>θ</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">x = \left[ \begin{array}{rrr} x_0 \\ x_1 \\ x_2 \\ ... \\ x_n \\ \end{array} \right] \in\mathbb{R}^{n+1} , \theta = \left[ \begin{array}{rrr} \theta_0 \\ \theta_1 \\ \theta_2 \\ ... \\ \theta_n \\ \end{array} \right] \in\mathbb{R}^{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.00404em;vertical-align:-2.75004em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.254em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.2049800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.8059800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.4069800000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.00798em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.2540000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em"><span style="top:-5.410000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-0.6099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.254em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.2049800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.8059800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.4069800000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.00798em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.2540000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:6.00404em;vertical-align:-2.75004em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.254em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.2049800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-2.8059800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.4069800000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.00798em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-5.2540000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.2500000000000004em"><span style="top:-5.410000000000001em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999998em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-0.6099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.254em"><span style="top:-1.0499800000000006em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.2049800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-2.8059800000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.4069800000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.00798em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-5.2540000000000004em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75004em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>θ</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">h_\theta(x) = \theta_0x_0 + \theta_1x_1 + \theta_2x_2 + \theta_3x_3 + ..... + \theta_nx_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">= \theta^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span></span></div><br><p>Tは「転置(transpose)」と呼ぶ</p></section><section class="aligncenter section-title"><h2>分類</h2></section><section class="aligncenter"><ul><li>メールのスパム判定</li><li>オンライン取引が詐欺かどうか</li><li>腫瘍が悪性か良性かどうか</li></ul><p>など</p></section><section class="aligncenter"><h2>バイナリ分類(２項分類)</h2><p>結果がYesかNoかなど二種類になるもの</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>y</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mstyle></mrow><annotation encoding="application/x-tex">\large y \in \{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.880248em;vertical-align:-0.23332799999999998em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mopen sizing reset-size6 size7">{</span><span class="mord sizing reset-size6 size7">0</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7">1</span><span class="mclose sizing reset-size6 size7">}</span></span></span></span></span></div><br><p>0: Negative Class</p><p>1: Positive Class</p><br><p>例えば</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">h_\theta(x) = \theta^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span></span></div><br><p>とすると</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>f</mi><mtext> </mtext><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0.5</mn><mo separator="true">,</mo><mtext> </mtext><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi mathvariant="normal">&quot;</mi><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">If~h_\theta(x) \geq 0.5,~predict~&quot;y=1&quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.07847em">I</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mspace nobreak"> </span><span class="mord">&quot;</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord">1</span><span class="mord">&quot;</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mi>f</mi><mtext> </mtext><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0.5</mn><mo separator="true">,</mo><mtext> </mtext><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi mathvariant="normal">&quot;</mi><mi>y</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">If~h_\theta(x) &lt; 0.5,~predict~&quot;y=0&quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.07847em">I</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mspace nobreak"> </span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mspace nobreak"> </span><span class="mord">&quot;</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">&quot;</span></span></span></span></span></div><br>という感じにすれば二値に分類できる</section><section class="aligncenter"><h2>ロジスティック回帰分析</h2><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mn>0</mn><mo>≤</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\large 0 \leq h_\theta(x) \leq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.936492em;vertical-align:-0.163164em"></span><span class="mord sizing reset-size6 size7">0</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">≤</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">≤</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.773328em;vertical-align:0em"></span><span class="mord sizing reset-size6 size7">1</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large h_\theta (x) = g(\theta ^Tx)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.342264em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8685533333333333em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac><mo>:</mo><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mtext> </mtext><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>L</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>c</mi><mtext> </mtext><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large g(z) = \frac{1}{1+e^{-z}} : Sigmoid~function (Logistic~function)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.04398em">z</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.508924em;vertical-align:-0.923196em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6778866666666667em"><span style="top:-3.0889999999999995em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.05764em">S</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mord mathdefault sizing reset-size6 size7">m</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">d</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10764em">f</span><span class="mord mathdefault sizing reset-size6 size7">u</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mord mathdefault sizing reset-size6 size7">c</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">L</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">s</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">c</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10764em">f</span><span class="mord mathdefault sizing reset-size6 size7">u</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mord mathdefault sizing reset-size6 size7">c</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mord mathdefault sizing reset-size6 size7">i</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">n</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div></section><section class="aligncenter"><p>Sigmoid関数の形(必ず0から1の間に値が収まる)</p><p><img src="https://cl.ly/40fdddaa949e/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-08%25252020.59.04.png" alt="Sigmoid"></p></section><section class="aligncenter"><h2>仮説関数の出力の扱い</h2><p>xを入力として渡した時にy=1となる確率</p><p>例：</p><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="right right right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="right right right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">腫</mi><mi mathvariant="normal">瘍</mi><mi mathvariant="normal">の</mi><mi mathvariant="normal">サ</mi><mi mathvariant="normal">イ</mi><mi mathvariant="normal">ズ</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">x = \left[ \begin{array}{rrr} x_0 \\ x_1 \\ \end{array} \right] = \left[ \begin{array}{rrr} 1 \\ 腫瘍のサイズ \\ \end{array} \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord cjk_fallback">腫</span><span class="mord cjk_fallback">瘍</span><span class="mord cjk_fallback">の</span><span class="mord cjk_fallback">サ</span><span class="mord cjk_fallback">イ</span><span class="mord cjk_fallback">ズ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">]</span></span></span></span></span></span></span></div><br><p>もし特徴ベクトルx1,x2から</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">h_\theta(x) = 0.7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span></span></span></span></span></div><br><p>を得たとするとy=1である確率は70%であると言える 式だとこういう感じで書く↓</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_\theta(x) = P(y=1|x;\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span></span></div><br><p>確率なので1になる確率と0になる確率を足すと1になる</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P(y=1|x;\theta) + P(y=0|x;\theta) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">0</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span></span></span></span></span></div></section><section class="aligncenter"><p>まとめると</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large h_\theta (x) = g(\theta ^Tx) = P(y=1|x;\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.342264em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8685533333333333em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.13889em">P</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">∣</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mpunct sizing reset-size6 size7">;</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.02778em">θ</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\large g(z) = \frac{1}{1+e^{-z}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.04398em">z</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.508924em;vertical-align:-0.923196em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6778866666666667em"><span style="top:-3.0889999999999995em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>u</mi><mi>p</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>e</mi><mtext> </mtext><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi mathvariant="normal">&quot;</mi><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">&quot;</mi><mtext> </mtext><mi>i</mi><mi>f</mi><mtext> </mtext><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">Suppose ~ predict ~ &quot;y=1&quot; ~ if ~ h_\theta(x) \geq 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathdefault" style="margin-right:0.05764em">S</span><span class="mord mathdefault">u</span><span class="mord mathdefault">p</span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mspace nobreak"> </span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mspace nobreak"> </span><span class="mord">&quot;</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mord">&quot;</span><span class="mspace nobreak"> </span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>c</mi><mi>t</mi><mtext> </mtext><mi mathvariant="normal">&quot;</mi><mi>y</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">&quot;</mi><mtext> </mtext><mi>i</mi><mi>f</mi><mtext> </mtext><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">predict ~ &quot;y=0&quot; ~ if ~ h_\theta(x) &lt; 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mspace nobreak"> </span><span class="mord">&quot;</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">0</span><span class="mord">&quot;</span><span class="mspace nobreak"> </span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></div><br><p>シグモイド関数は0以上の入力で0.5以上となり、0以下で0.5未満となるので↓が成り立つ</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0.5</mn><mtext> </mtext><mi>w</mi><mi>h</mi><mi>e</mi><mi>n</mi><mtext> </mtext><mi>z</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g(z) \geq 0.5~when~z \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.02691em">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.04398em">z</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">h_\theta(x) = g(\theta^Tx) \ge 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mi>h</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>r</mi><mtext> </mtext><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">whenever~ \theta^Tx \ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0273009999999998em;vertical-align:-0.13597em"></span><span class="mord mathdefault" style="margin-right:0.02691em">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span></span></span></span></span></div><br><p>つまり</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo>≥</mo><mn>0</mn><mtext> </mtext><mi mathvariant="normal">で</mi><mi mathvariant="normal">あ</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">時</mi><mi mathvariant="normal">は</mi><mi mathvariant="normal">常</mi><mi mathvariant="normal">に</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\theta^Tx \ge 0~である時は常にy=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0273009999999998em;vertical-align:-0.13597em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em"></span><span class="mord">0</span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">で</span><span class="mord cjk_fallback">あ</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">時</span><span class="mord cjk_fallback">は</span><span class="mord cjk_fallback">常</span><span class="mord cjk_fallback">に</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi><mo>&lt;</mo><mn>0</mn><mtext> </mtext><mi mathvariant="normal">で</mi><mi mathvariant="normal">あ</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">時</mi><mi mathvariant="normal">は</mi><mi mathvariant="normal">常</mi><mi mathvariant="normal">に</mi><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta^Tx &lt; 0~である時は常にy=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9304309999999999em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em"></span><span class="mord">0</span><span class="mspace nobreak"> </span><span class="mord cjk_fallback">で</span><span class="mord cjk_fallback">あ</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">時</span><span class="mord cjk_fallback">は</span><span class="mord cjk_fallback">常</span><span class="mord cjk_fallback">に</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span></span></span></span></span></div><br><p><img src="https://cl.ly/ac0593314097/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252015.27.45.png" alt="sigmoid"></p></section><section class="aligncenter"><h2>Decision Boundary (決定境界)</h2><p><img src="https://cl.ly/2b84d35f4a66/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252015.40.41.png" alt="Decision Boundary"></p><p>決定境界はトレーニングセットの性質ではなく仮説とパラメータの性質</p></section><section class="aligncenter"><h2>ロジスティック回帰分析の目的関数</h2></section><section class="aligncenter"><h2>データの確認</h2><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mtext> </mtext><mi>s</mi><mi>e</mi><mi>t</mi><mo>:</mo><mtext>  </mtext><mrow><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">Training~set : ~~{(x^{(1)},y^{(1)}),(x^{(2)},y^{(2)}),...,(x^{(m)},y^{(m)})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.13889em">T</span><span class="mord mathdefault" style="margin-right:0.02778em">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mspace nobreak"> </span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">m</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mtext> </mtext><mi>e</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>s</mi><mo>:</mo><mtext>  </mtext><mi>x</mi><mo>∈</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="right right right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">m ~ examples:~~ x \in \left[ \begin{array}{rrr} x_0 \\ x_1 \\ ... \\ x_n \\ \end{array} \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathdefault">m</span><span class="mspace nobreak"> </span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:4.80204em;vertical-align:-2.15003em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em"><span style="top:-1.6499900000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.80499em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.40599em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.65201em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6500000000000004em"><span style="top:-4.8100000000000005em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span><span style="top:-1.2099999999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6520099999999998em"><span style="top:-1.6499900000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.80499em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.40599em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.65201em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em"><span></span></span></span></span></span></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mtext> </mtext><mi>y</mi><mo>∈</mo><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow></mrow><annotation encoding="application/x-tex">x_0 = 1, ~ y\in {0,1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord">1</span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">仮</mi><mi mathvariant="normal">説</mi><mi mathvariant="normal">関</mi><mi mathvariant="normal">数</mi><mo>:</mo><mtext>  </mtext><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">仮説関数: ~~h_\theta(x) = \frac{1}{1+e^{-\theta^Tx}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord cjk_fallback">仮</span><span class="mord cjk_fallback">説</span><span class="mord cjk_fallback">関</span><span class="mord cjk_fallback">数</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.125635em;vertical-align:-0.804195em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.279135em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.830865em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7740928571428571em"><span style="top:-2.786em;margin-right:0.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.804195em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><br><p>どうやってパラメータθの値を決定するか？</p></section><section class="aligncenter"><h2>目的関数(Cost Function)</h2><p>線形回帰で使っていた式:</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large J(\theta) = \frac{1}{m}\sum_{i = 1}^{m} \frac{1}{2} (h_\theta(x^{(i)}) - y^{(i)} )^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.02778em">θ</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3956em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><p>これを以下のように定義する</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\large Cost(h_\theta(x), y) = \frac{1}{2}(h_\theta(x)-y)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.07153em">C</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">s</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.408928em;vertical-align:-0.8232em"></span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.3111519999999999em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mclose sizing reset-size6 size7"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><br><p>目的関数を使い回せるのかと思いきや、シグモイド関数が非線形なので、Jθを求めようとすると左のように局所解が何個もある状態になってしまうらしい</p><br><p><img src="https://cl.ly/6d1da35b2458/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252016.10.58.png" alt="convex"></p></section><section class="aligncenter"><h2>ロジスティック回帰の目的関数(Cost Function)</h2><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>y</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>y</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mrow><annotation encoding="application/x-tex">\large Cost(h_\theta(x),y) = \left\{ \begin{array}{ll} -log(h_\theta(x)) &amp; if~y=1 \\ -log(1-h_\theta(x)) &amp; if~y=0 \\ \end{array} \right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.07153em">C</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">s</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.19003em"></span><span class="minner sizing reset-size6 size7"><span class="mopen sizing reset-size7 size6 delimcenter" style="top:-0.04999999999999999em"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.81em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:-2.61em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.81em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mord">1</span></span></span><span style="top:-2.61em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em">f</span><span class="mspace nobreak"> </span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span></span></span></span></span></div><br><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">も</mi><mi mathvariant="normal">し</mi><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">で</mi><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mi mathvariant="normal">な</mi><mi mathvariant="normal">ら</mi><mi mathvariant="normal">ば</mi><mi mathvariant="normal">コ</mi><mi mathvariant="normal">ス</mi><mi mathvariant="normal">ト</mi><mi mathvariant="normal">は</mi><mn>0</mn><mi mathvariant="normal">と</mi><mi mathvariant="normal">な</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">。</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">か</mi><mi mathvariant="normal">し</mi><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mi mathvariant="normal">で</mi><mi mathvariant="normal">あ</mi><mi mathvariant="normal">っ</mi><mi mathvariant="normal">た</mi><mi mathvariant="normal">場</mi><mi mathvariant="normal">合</mi><mi mathvariant="normal">コ</mi><mi mathvariant="normal">ス</mi><mi mathvariant="normal">ト</mi><mi mathvariant="normal">は</mi><mi mathvariant="normal">∞</mi><mi mathvariant="normal">と</mi><mi mathvariant="normal">な</mi><mi mathvariant="normal">る</mi><mi mathvariant="normal">。</mi></mrow><annotation encoding="application/x-tex">もしy=1でh_\theta(x)=1ならばコストは0となる。しかしh_\theta(x)=0であった場合コストは\inftyとなる。</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em"></span><span class="mord cjk_fallback">も</span><span class="mord cjk_fallback">し</span><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mord cjk_fallback">で</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mord cjk_fallback">な</span><span class="mord cjk_fallback">ら</span><span class="mord cjk_fallback">ば</span><span class="mord cjk_fallback">コ</span><span class="mord cjk_fallback">ス</span><span class="mord cjk_fallback">ト</span><span class="mord cjk_fallback">は</span><span class="mord">0</span><span class="mord cjk_fallback">と</span><span class="mord cjk_fallback">な</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">。</span><span class="mord cjk_fallback">し</span><span class="mord cjk_fallback">か</span><span class="mord cjk_fallback">し</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">0</span><span class="mord cjk_fallback">で</span><span class="mord cjk_fallback">あ</span><span class="mord cjk_fallback">っ</span><span class="mord cjk_fallback">た</span><span class="mord cjk_fallback">場</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">コ</span><span class="mord cjk_fallback">ス</span><span class="mord cjk_fallback">ト</span><span class="mord cjk_fallback">は</span><span class="mord">∞</span><span class="mord cjk_fallback">と</span><span class="mord cjk_fallback">な</span><span class="mord cjk_fallback">る</span><span class="mord cjk_fallback">。</span></span></span></span></span></div><br><br><p><img src="https://cl.ly/317f2d9a120d/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252016.29.27.png" alt="y=1"></p><br><p><img src="https://cl.ly/25b895e59c53/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252016.33.42.png" alt="y=0"></p></section><section class="aligncenter"><h2>ロジスティック回帰の目的関数(Cost Function)</h2><p>yが必ず0か1になるので、下記のように式を１つにできる</p><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>y</mi><mtext> </mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\large Cost(h_\theta(x), y) = -y~log(h_\theta(x))-(1-y)log(1-h_\theta(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.07153em">C</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7">s</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7">−</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.01968em">l</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">y</span><span class="mclose sizing reset-size6 size7">)</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.01968em">l</span><span class="mord mathdefault sizing reset-size6 size7">o</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.03588em">g</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7">x</span><span class="mclose sizing reset-size6 size7">)</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></div><br>片方が必ず0になる</section><section class="aligncenter"><h2>Gradient Decent</h2><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mrow><mo fence="true">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mi>l</mi><mi>o</mi><mi>g</mi><mtext> </mtext><mi>h</mi><mi>θ</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\large J(\theta) = - \frac{1}{m}\left[ \sum_{i = 1}^{m} y^{(i)}log~h\theta(x^{(i)})+(1-y^{(i)})log (1-h_\theta(x^{(i)}))\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.09618em">J</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.02778em">θ</span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.6068419999999994em;vertical-align:-1.5068219999999999em"></span><span class="mord sizing reset-size6 size7">−</span><span class="mord sizing reset-size6 size7"><span class="mopen nulldelimiter sizing reset-size7 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span style="top:-2.5140000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.43em"><span class="pstrut" style="height:3.2em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.8770000000000002em"><span class="pstrut" style="height:3.2em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size7 size6"></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="minner sizing reset-size6 size7"><span class="mopen sizing reset-size7 size6"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1000199999999998em"><span style="top:-2.3000000000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-4.10002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.50002em"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mspace nobreak"> </span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose sizing reset-size7 size6"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1000199999999998em"><span style="top:-2.3000000000000003em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-4.10002em"><span class="pstrut" style="height:3.1550000000000002em"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.50002em"><span></span></span></span></span></span></span></span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi mathvariant="normal">の</mi><mi>θ</mi><mi mathvariant="normal">を</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">小</mi><mi mathvariant="normal">化</mi><mi mathvariant="normal">し</mi><mi mathvariant="normal">た</mi><mi mathvariant="normal">い</mi></mrow><annotation encoding="application/x-tex">J(\theta)の\thetaを最小化したい</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mord cjk_fallback">の</span><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="mord cjk_fallback">を</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">化</span><span class="mord cjk_fallback">し</span><span class="mord cjk_fallback">た</span><span class="mord cjk_fallback">い</span></span></span></span></span></div><br><div class="math"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><mi>R</mi><mi>e</mi><mi>p</mi><mi>e</mi><mi>a</mi><mi>t</mi><mo>:</mo><mtext> </mtext><msub><mi>θ</mi><mi>j</mi></msub><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mi>α</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><msubsup><mi>x</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\large Repeat:~\theta_j := \theta_j - \alpha \sum_{i=0}^{m} (h_\theta(x^{(i)})-y^{(i)})x_j^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.00773em">R</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">p</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mord mathdefault sizing reset-size6 size7">a</span><span class="mord mathdefault sizing reset-size6 size7">t</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mspace nobreak sizing reset-size6 size7"> </span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel sizing reset-size6 size7">:</span></span><span class="base"><span class="strut" style="height:0.44024399999999997em;vertical-align:0em"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em"><span style="top:-2.044315em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2000050000000004em"><span class="pstrut" style="height:3.2em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em"><span class="pstrut" style="height:3.2em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em"><span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31296em"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.675168em;vertical-align:-0.4614080000000001em"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.913em"><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose sizing reset-size6 size7">)</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0114666666666667em"><span style="top:-2.54512em;margin-left:0em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.3114666666666666em;margin-right:0.04166666666666667em"><span class="pstrut" style="height:2.8em"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3845066666666668em"><span></span></span></span></span></span></span></span></span></span></span></div><br>θjの更新は同時にやる<br><br>線形回帰の時と仮説関数が違うだけなのでほぼ同じ。 これでθを求めることができる</section><section class="aligncenter"><h2>マルチクラスの分類問題</h2><ul><li>one vs all classificationと呼ばれる</li><li>メールのフォルダ分け、複数種類のタグ付け</li><li>２値分類ではyが0,1しか取らなかったが、マルチクラスの分類問題では1,2,3などカテゴリの数だけyの取りうる値が存在する</li></ul></section><section class="aligncenter"><p>それぞれのクラスについて陰性か陽性かを判断する分類器を作り</p><p>入力を与えた時に最も数値（確率）が高かったものを採用すれば良い</p><br><p><img src="https://cl.ly/006096a9164c/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252018.11.18.png" alt="figure"></p></section><section class="aligncenter section-title"><h2>過学習(Overfitting)</h2></section><section class="aligncenter"><h2>過学習(Overfitting)</h2><ul><li>そのモデルがトレーニングデータに対しては機能するが、未知のデータに対して機能せず、汎化できていない状態(Overfitting, High Variance)</li><li>逆に学習が足りていない場合はUnderfitting, High biasなどと呼ばれる</li></ul><p><img src="https://cl.ly/98f7f1fac40b/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252018.22.15.png" alt="overfitting"> <img src="https://cl.ly/779c7317619d/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588%2525202019-09-19%25252018.32.02.png" alt="overfitting"></p></section><section class="aligncenter"><h2>過学習の解決方法</h2><ul><li>特徴量を減らす<ul><li>家の広さ、築年数、コンビニまでの距離などなど色々特徴量を与えれば与えるほど正確になると思いがちだが、重要でない特徴量は使わないことも重要（pandasとかで相関調べたり自動で抽出したり）</li></ul></li><li>正則化(Regularization)<ul><li>学習の際に複雑さが増すことに対するペナルティを設ける</li><li>L1正則化とL2正則化がある</li><li>値を0から1にするために行う正規化とは違うよ</li></ul></li><li>与えられたデータ全てを使って学習を行うのではなく、訓練データ、テストデータに分割して学習を行う<ul><li>Stratified K-fold cross validationとかがよく使われる</li></ul></li></ul><p>時間がないので詳細については割愛するがとりあえずGoogle Colabolatoryでロジスティック回帰分析してみよう</p></section><section class="aligncenter section-title"></section></article></div><script type="text/javascript" src="runtime.d4b35dfff21fa83fe691.bundle.js"></script><script type="text/javascript" src="vendor.6.c9a6d243b91f1dfe3fc8.bundle.js"></script><script type="text/javascript" src="main.3.1c23ead6bb8bc9504bf9.bundle.js"></script></body></html>